---
title: "Project Proposal"
author: "8조 박지우, 신대형, 전재현, 조용수"
date: "`r Sys.Date()`"
output: rmarkdown::html_document

---

```{r setup, include = FALSE}
#You do not need to touch this chunk
#words after "#" sign are treated as comments
#It is strongly recommanded to use English in r markdown
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#install.packages("ggplot2")    # ggplot2 패키지 설치(한번만 설치하면 됨)
#install.packages("dplyr")      # dplyr 패키지 설치(한번만 설치하면 됨)
#install.packages("GGally")     # GGally 패키지 설치(한번만 설치하면 됨)
#install.packages("gridExtra")  # gridExtra 패키지 설치(한번만 설치하면 됨)
library(ggplot2)
library(dplyr)
library(GGally)
library(gridExtra)
```


# Rmarkdown template(Title)


## 1. 데이터에 대한 설명

### Files

- train.csv : 와인의 성분 및 품질이 담긴 데이터
- test.csv : 와인의 성분이 담긴 데이터(품질을 예측할 필요)


### Columns

- index : 구분자. 말 그대로 번호를 나타내 주는 index이다.
- quality : 품질. 0에서 10 사이의 숫자로 나타내어져 있다.
- fixed acidity : 고정산. 쉽게 증발하지 않는 산을 의미
- volatile acidity : 휘발성산. 와인을 상하게 하는 효모나 박테리아에 의해 만들어지며 높은 농도(1.2~1.3g/L)일 경우 식초와 같은 불쾌한 맛을 낸다.
- citric acid : 시트르산. 와인의 신선도와 맛에 영향을 미친다.
- residual : 잔당. 발효 후 와인 속에 남아있는 당분.
- chlorides : 염화물. 와인의 짠맛을 좌우한다.
- free sulfur dioxide : 독립 이산화황. 결합되지 않은 형태의 이산화황을 의미. 와인의 보존재로 사용되는 경우가 많다.
- total sulfur dioxide : 총 이산화황. Free & Bound form Sulfur dioxide를 합친 것이다.
- density : 밀도. 와인을 마실 때의 바디감을 결정한다.알코올 도수와 설탕의 농도에 영향을 많이 받는다.
- PH : 수소이온농도. 값이 낮을수록 강한 산성임을 의미한다.
- sulphates : 황산염. 이산화황 수용액이 산화되며 만들어진 염이다. 와인의 맛을 개선하고 신선도를 유지시키며 생동감을 준다.
- alcohol : 도수. 알코올의 농도.
- type : 종류. 레드 와인인지 화이트 와인인지를 구분.



## 2. 연구가설

1. 와인의 quality는 density에 영향을 많이 받을 것이다.

2. 적절한(너무 낮지도, 높지도 않은) 산도와 당도를 가진 와인이 quality가 더 높을 것이다.

3. 와인의 type별로 와인에 quality에 영향을 주는 변수가 달라질 것이다.



## 3. 각 연구가설과 관련된 탐색적 자료 분석

```{r}
df = read.csv("data/train.csv", header = TRUE)    # csv file을 df라는 변수에 저장
head(df)
```


```{r}
glimpse(df)    # 변수별로 대략적인 형태를 볼 수 있음
```

```{r}
summary(df)    # 최대값, 최소값, 사분위수 등의 기본적인 통계량 확인 가능
```
```{r}
table(df$type)
```


'type' column이 범주형 변수라서 제대로 summary가 되지 않아 table 함수로 분할표를 그려주었다. red와 white 두 종류밖에 없음을 확인할 수 있다.

```{r}
colSums(is.na(df))
```

결측치는 없음을 확인할 수 있다.

```{r}
df_red <- df %>% filter(type=='red')
df_red %>% head
df_white <- df %>% filter(type=='white')
df_white %>% head
```

type별로 데이터를 나누어 분석해주기 위해 red wine 데이터를 df_red에, white wine 데이터를 df_white에 저장해주었다.


```{r}

panel.cor <- function(x, y, digits = 2, prefix = "", cex.cor, ...){
  usr <- par("usr"); on.exit(par(usr))
  par(usr = c(0, 1, 0, 1))
  r <- abs(cor(x, y))
  txt <- format(c(r, 0.123456789), digits = digits)[1]
  txt <- paste0(prefix, txt)
  if(missing(cex.cor)) cex.cor <- 0.8/strwidth(txt)
  text(0.5, 0.5, txt, cex = cex.cor * r)
}

pairs(df_red[2:13] %>%  sample_n(1000),
      upper.panel = panel.cor)# red wine 데이터의 변수별 산점도행렬 확인

pairs(df_white[2:13] %>%  sample_n(1000),
      upper.panel = panel.cor)# red wine 데이터의 변수별 산점도행렬 확인

```

두 변수 사이의 상관계수와 산점도를 표시하여 분석해보았다. red wine과 white wine 모두 quality와 가장 상관계수가 높은 변수는 alcohol임을 알 수 있다.



```{r fig.width = 10, fig.height=7}


# wine의 type별 column 변수의 histogram 분포

pl1 = df %>% ggplot(aes(x=quality)) +
  geom_histogram() +
  facet_wrap(~ type)

pl2 = df %>% ggplot(aes(x=fixed.acidity)) +
  geom_density() +
  facet_wrap(~ type)

pl3 = df %>% ggplot(aes(x=volatile.acidity)) +
  geom_density() +
  facet_wrap(~ type)

pl4 = df %>% ggplot(aes(x=citric.acid)) +
  geom_density() +
  facet_wrap(~ type)

pl5 = df %>% ggplot(aes(x=residual.sugar)) +    
  geom_density() +
  facet_wrap(~ type)

pl6 = df %>% ggplot(aes(x=chlorides)) +
  geom_density() +
  facet_wrap(~ type)

pl7 = df %>% ggplot(aes(x=free.sulfur.dioxide)) +
  geom_density() +
  facet_wrap(~ type)

pl8 = df %>% ggplot(aes(x=total.sulfur.dioxide)) +
  geom_density() +
  facet_wrap(~ type)

pl9 = df %>% ggplot(aes(x=density)) +
  geom_density() +
  facet_wrap(~ type)

pl10 = df %>% ggplot(aes(x=pH)) +
  geom_density() +
  facet_wrap(~ type)

pl11 = df %>% ggplot(aes(x=sulphates)) +
  geom_density() +
  facet_wrap(~ type)

pl12 = df %>% ggplot(aes(x=alcohol)) +
  geom_density() +
  facet_wrap(~ type)

grid.arrange(pl1, pl2, pl3, pl4, pl5, pl6, pl7, pl8, pl9, pl10, pl11, pl12, nrow=4, ncol=3)


```

```{r fig.width= 10, fig.height=20}

# wine의 type별 column 변수의 boxplot 분포

box1 <-  df %>% ggplot(aes(quality, fixed.acidity, group=quality)) +
  geom_jitter(col='gray') +
  geom_boxplot(alpha = .5, outlier.color = 'red') +
  facet_wrap(~ type)

box2 <-  df %>% ggplot(aes(quality, volatile.acidity, group=quality)) +    # red 와인의 경우 음의 상관관계
  geom_jitter(col='gray') +
  geom_boxplot(alpha = .5, outlier.color = 'red') +
  facet_wrap(~ type)

box3 <- df %>% ggplot(aes(quality, citric.acid, group=quality)) +    # red 와인의 경우 양의 상관관계
  geom_jitter(col='gray') +
  geom_boxplot(alpha = .5, outlier.color = 'red') +
  facet_wrap(~ type)

box4 <- df %>% ggplot(aes(quality, residual.sugar, group=quality)) +    
  geom_jitter(col='gray') +
  geom_boxplot(alpha = .5, outlier.color = 'red') +
  facet_wrap(~ type)

box5 <- df %>% ggplot(aes(quality, chlorides, group=quality)) +
  geom_jitter(col='gray') +
  geom_boxplot(alpha = .5, outlier.color = 'red') +
  facet_wrap(~ type)

box6 <- df %>% ggplot(aes(quality, free.sulfur.dioxide, group=quality)) +
  geom_jitter(col='gray') +
  geom_boxplot(alpha = .5, outlier.color = 'red') +
  facet_wrap(~ type)

box7 <- df %>% ggplot(aes(quality, total.sulfur.dioxide, group=quality)) +
  geom_jitter(col='gray') +
  geom_boxplot(alpha = .5, outlier.color = 'red') +
  facet_wrap(~ type)

box8 <- df %>% ggplot(aes(quality, density, group=quality)) +
  geom_jitter(col='gray') +
  geom_boxplot(alpha = .5, outlier.color = 'red') +
  facet_wrap(~ type)

box9 <- df %>% ggplot(aes(quality, pH, group=quality)) +
  geom_jitter(col='gray') +
  geom_boxplot(alpha = .5, outlier.color = 'red') +
  facet_wrap(~ type)

box10 <- df %>% ggplot(aes(quality, sulphates, group=quality)) +    # red의 경우 양의 상관관계
  geom_jitter(col='gray') +
  geom_boxplot(alpha = .5, outlier.color = 'red') +
  facet_wrap(~ type)

box11 <- df %>% ggplot(aes(quality, alcohol, group=quality)) +    # 둘 다 대체적으로 양의 상관관계
  geom_jitter(col='gray') +
  geom_boxplot(alpha = .5, outlier.color = 'red') +
  facet_wrap(~ type)

grid.arrange(box1, box2, box3, box4, box5, box6, box7, box8, box9, box10, box11, nrow=6, ncol=2)

```



```{r}
df_white %>% ggplot(aes(x = citric.acid, y = residual.sugar, color=as.factor(quality))) +
  geom_point()
```

산점도 그림에 quality별로 서로 다른 color를 주어 전체적인 형태를 살펴보려고 하였으나 여러 색이 겹쳐 알아보기가 어렵다. mutate() 함수를 이용하여 새로운 new_quality column을 만들었다. (quality <=5 이면 new_quality='low', quality>=7이면 new_quality='high')

이후 new_quality별로 color를 다르게 주며 두 집단 사이에 유의미한 차이가 있는지 알아보았다.

```{r}
df_white %>% 
  filter(quality!=6) %>% 
  mutate(new_quality = ifelse(quality > 6, 'high', 'low')) %>% 
  ggplot(aes(x = citric.acid, y = residual.sugar, color=new_quality)) +
  geom_point()
   
```

우선 citric.acid는 high group이 확실히 low group보다 전체적으로 안쪽 범위에 몰려 있는 것을 확인할 수 있다.

residual.sugar도 전체적으로 high group이 편차가 더 낮은 듯 하다.

  


## 4. time table

4월 8일 : 줌을 통해 가설 보완, 데이터 분석, 시각화

~4월 23일 : 데이터 분석, 가설 검정 및 결과 기록

~5월 2일 : 가설 보완 및 추가적인 가설 설정

~5월 7일 : 경과보고서 작성

~5월 23일 : 추가 가설 검정 및 결과 기록

~6월 4일 : 최종보고서 작성, 발표 자료 준비



## 5. 각 조원의 예상 역할

박지우 : 가설 설정, 가설 검정 등

신대형 : 자료 조사, 데이터 분석 등

전재현 : 데이터 분석, 결과 정리(markdown 파일 제작) 등

조용수 : 가설 설정, 데이터 시각화 등

역할은 고정적인 것은 아니며 유동적으로 바뀔 수 있을 것 같다.
